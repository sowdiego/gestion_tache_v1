{% load bootstrap5 %}
{% bootstrap_css %}
{% bootstrap_javascript %}
{% block content %}
<!DOCTYPE html>  
<html lang="en">  
<head>  
    <meta charset="UTF-8">  
    <title>Mes Taches</title>  
</head>  
<body>  
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-10" style="margin-top: 30px;">
                <a href="/create_tache" class="btn btn-primary btn-sm">Ajouter une nouvelle tache</a>
            </div>
            <div class=" col-md-2 " style="margin-top: 15px;">
                <a style="margin-left: 100px;" href="/logout" class="btn btn-success btn-sm">Se déconnecter</a>
            </div>
        </div>
        
        <div class="row justify-content-center" style="margin-top: 50px;">
          <div class="col-3">
            <div class="card">
                <div class="card-header">
                    <h5>Appliquer des filtres</h5>
                </div>
                <div class="card-body">
                  <form method="post">
                    {% csrf_token %}
                    {% bootstrap_form form %}
                    {% buttons %}
                      <button class="btn btn-primary" type="submit">Filtrer</button>
                      <a href="/acceuil" class="btn btn-warning">Réinitialiser</a>
                    {% endbuttons %}
                  </form>  
                </div>
            </div>
          </div>
          <div class="col-9">
            {% if user.is_authenticated %}
                  <div class="toast" role="alert" aria-live="assertive" aria-atomic="true">
                    <div class="toast-header">
                      <img src="..." class="rounded me-2" alt="...">
                      <strong class="me-auto">Gestion des taches</strong>
                      <small>Acceuil</small>
                      <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
                    </div>
                    <div class="toast-body">
                      <p>Welcome, {{ user.get_username }}. Thanks for logging in.</p>
                    </div>
                  </div>
            {% endif %}
            <div class="card">
                <div class="card-header">
                    <h5>Ma Liste des taches</h5>
                </div>
                <div class="card-body">
                    <table class="table table-striped table-bordered table-sm">  
                        <thead class="thead-dark">  
                        <tr>  
                            <th>Tache ID</th>  
                            <th>Titre</th>  
                            <th>Description</th>
                            <th>Date création</th> 
                            <th>Date échéance</th>
                            <th>Statut</th> 
                            <th>Action</th>      
                        </tr>  
                        </thead>  
                        <tbody>  
                    {% for tache in taches %}  
                        <tr>  
                            <td>{{ tache.id}}</td>  
                            <td>{{ tache.titre }}</td>  
                            <td>{{ tache.description }}</td>
                            <td>{{ tache.date_creation | date:"M d, Y " }}</td>
                            <td>{{ tache.date_echeance | date:"M d, Y "}}</td> 
                            {% if tache.statut %}
                            <td><span class="badge bg-success">Terminée</span></td>
                            {% else %}  
                            <td><span class="badge bg-primary">En cour</span></td>
                            {% endif %}   
                            
                            <td>  
                                <a href="/edit_tache/{{tache.id}}"><span class="btn btn-warning btn-sm" >Edit</span></a>  
                                <a href="/delete/{{ tache.id }}" class="btn btn-danger btn-sm">Delete</a>  
                            </td>  
                        </tr>  
                    {% empty %}
                        <tr> <center> <h5 style="color: brown;"> Aucune tache trouvée.</h5></center> </tr>
                    {% endfor %}  
                        </tbody>  
                    </table>  
                    <div class="pagination">
                        <span class="step-links">
                            {% if taches.has_previous %}
                                <a href="?page=1">&laquo; première</a>
                                <a href="?page={{ taches.previous_page_number }}">précédent</a>
                            {% endif %}
                
                            <span class="current-page">
                                Page {{ taches.number }} / {{ taches.paginator.num_pages }}.
                            </span>
                
                            {% if taches.has_next %}
                                <a href="?page={{ taches.next_page_number }}">Suivante</a>
                                <a href="?page={{ taches.paginator.num_pages }}">Derniere &raquo;</a>
                            {% endif %}
                        </span>
                    </div>
                </div>  
            </div>
          </div>
        </div>
      </div>
</body>  
</html>
{% endblock content %}